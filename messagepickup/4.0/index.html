<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.css" data-identity="gatsby-global-css">:root{--color-primary:#29679c;--color-primary-hover:#245a88;--color-primary-pressed:#204f78;--color-secondary:#f1c232;--color-secondary-hover:#e5b82f;--color-secondary-pressed:#d9af2d;--color-error:#ef2727;--color-background:#fff;--color-background-primary:rgba(41,103,156,0.07);--color-background-primary-hover:rgba(41,103,156,0.15);--color-background-primary-pressed:rgba(41,103,156,0.21);--color-background-secondary:#fdf6e0;--color-text-primary:#000;--color-text-secondary:#666;--color-tertiary:#999;--color-production:#1fad3e;--color-background-production:rgba(31,173,62,0.07);--color-demonstrated:#d9af2d;--color-background-demonstrated:rgba(217,175,45,0.1);--color-proposed:#666;--color-background-proposed:hsla(0,0%,40%,0.07)}*,:after,:before{box-sizing:border-box;margin:0;padding:0}a{text-decoration:none}button{background:none;border:none}ol,ul{list-style:none}fieldset{border:none}body{color:var(--color-text-primary);font-family:Inter,sans-serif;font-size:17px;font-weight:400;line-height:24px}.content{margin:0 auto;max-width:1296px;padding:72px 32px}@media screen and (max-width:768px){.content{padding:48px 16px}}.font-caption{font-size:12px}.font-caption,.font-footnote{font-weight:400;line-height:16px}.font-footnote{font-size:13px}.font-subheadline{font-size:15px;font-weight:500;line-height:20px}.font-callout{font-size:16px;font-weight:600;line-height:24px}.font-body{font-weight:400}.font-body,.font-headline{font-size:17px;line-height:24px}.font-headline,.font-title-3{font-weight:600}.font-title-3{font-size:20px;line-height:32px}.font-title-2{font-size:22px;font-weight:700;line-height:32px}.font-title-1{font-size:28px;font-weight:800;line-height:32px}.font-title-large{font-size:34px;font-weight:900;line-height:40px}.visually-hidden{clip:rect(0 0 0 0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.rounded{border-radius:4px}.shadow-medium{box-shadow:0 12px 12px rgba(0,0,0,.03),0 8px 16px rgba(0,0,0,.03),0 1px 24px rgba(0,0,0,.03)}.grid-3{grid-column-gap:72px;grid-row-gap:24px;display:grid;grid-template-columns:repeat(3,1fr);height:100%;width:100%}@media screen and (max-width:768px){.grid-3{grid-template-columns:1fr}.hide-mobile{display:none}}@media screen and (min-width:768px){.hide-desktop{display:none}}@media print{.hide-print{display:none}}.no-scroll{height:100%;overflow:hidden}button:focus,button:hover{cursor:pointer}.emoji-icon{display:inline!important;margin:1px 0 0!important;position:relative!important;top:5px!important;width:25px!important}.task-list-item{list-style-type:none}.Header-module--header--1Qt4T{background-color:var(--color-background);color:var(--color-text-primary);padding:12px 32px}@media screen and (max-width:768px){.Header-module--header--1Qt4T{padding:12px 16px}}.Header-module--container--3KhaC{align-items:center;display:grid;grid-template-columns:200px 1fr 200px;margin:0 auto;max-width:1376px;width:100%}@media screen and (max-width:768px){.Header-module--container--3KhaC{grid-column-gap:16px;grid-template-columns:auto 1fr}}.Header-module--search--ucYp8{display:flex;justify-content:center}.Header-module--search--ucYp8:empty+.Header-module--linksContainer--WRDuP{display:block;grid-column:3;grid-row:1}.Header-module--active--1N9yZ{pointer-events:none}.Header-module--primary--yIDLc{background-color:var(--color-primary);color:var(--color-background)}.Header-module--logo--RPmCm{align-items:center;color:inherit;display:flex}.Header-module--logo--RPmCm:hover{color:var(--color-secondary-hover)}.Header-module--logo--RPmCm:focus{color:var(--color-secondary-pressed)}.Header-module--logoImg--f8A17{display:block;height:48px;width:48px}.Header-module--logoText--EwM4-{margin-left:16px}.Header-module--links--3cZB-{display:flex;justify-content:flex-end}.Header-module--link--4ebYS{color:inherit;margin-left:16px}.Header-module--link--4ebYS:hover{color:var(--color-secondary-hover)}.Header-module--link--4ebYS:focus{color:var(--color-secondary-pressed)}.Layout-module--layout--36KWw{background-color:var(--color-background);min-height:100vh}.Layout-module--primary--3dHHh{background-color:var(--color-background-primary)}.Layout-module--accent--3cy0V{background-color:var(--color-primary)}.Features-module--feature--2-Z3l{display:grid;grid-template-columns:auto;grid-template-rows:auto auto auto}@media screen and (max-width:768px){.Features-module--feature--2-Z3l{grid-template-columns:auto 1fr;grid-template-rows:auto auto}}.Features-module--icon--3Lduc{grid-row:1;height:72px;width:72px}@media screen and (max-width:768px){.Features-module--icon--3Lduc{grid-column:2;height:32px;margin-left:8px;width:32px}}.Features-module--title--1TZf3{grid-column:span 2;grid-row:2;margin:32px 0 24px}@media screen and (max-width:768px){.Features-module--title--1TZf3{font-size:20px;font-weight:600;grid-column:1;grid-row:1;line-height:32px;margin:0 0 12px}}.Features-module--text--LRQ-w{grid-column:span 2}.Features-module--text--LRQ-w a{color:var(--color-primary)}.Features-module--text--LRQ-w a:hover{color:var(--color-primary-hover)}.Features-module--text--LRQ-w a:focus{color:var(--color-primary-pressed)}.Book-module--title--3XmVr{margin-bottom:72px;word-break:break-word}@media screen and (max-width:768px){.Book-module--title--3XmVr{font-size:28px;font-weight:800;line-height:32px;margin-bottom:24px}}@media print{.Book-module--title--3XmVr{margin-bottom:40px}}.Book-module--body--Hy0rr{grid-column:span 2;overflow:hidden;word-break:break-word}@media screen and (max-width:768px){.Book-module--body--Hy0rr{grid-column:1}}@media print{.Book-module--body--Hy0rr{grid-column:span 3;overflow:visible}}.Book-module--body--Hy0rr>:first-child{margin-top:0}.Book-module--body--Hy0rr h1,.Book-module--body--Hy0rr h2{font-size:22px;font-weight:700;line-height:32px}.Book-module--body--Hy0rr h3{font-size:20px;font-weight:600;line-height:32px}.Book-module--body--Hy0rr h4,.Book-module--body--Hy0rr h5,.Book-module--body--Hy0rr h6{font-size:1rem}.Book-module--body--Hy0rr h1,.Book-module--body--Hy0rr h2,.Book-module--body--Hy0rr h3,.Book-module--body--Hy0rr h4,.Book-module--body--Hy0rr h5,.Book-module--body--Hy0rr h6{margin-bottom:16px;margin-top:24px}.Book-module--body--Hy0rr ol,.Book-module--body--Hy0rr p,.Book-module--body--Hy0rr table,.Book-module--body--Hy0rr ul{margin-bottom:16px}.Book-module--body--Hy0rr a{color:var(--color-primary)}.Book-module--body--Hy0rr a:hover{color:var(--color-primary-hover)}.Book-module--body--Hy0rr a:focus{color:var(--color-primary-pressed)}.Book-module--body--Hy0rr ul{list-style:initial}.Book-module--body--Hy0rr ul ul{list-style:circle}.Book-module--body--Hy0rr ul ul ul{list-style-type:square}.Book-module--body--Hy0rr ol{list-style:initial}.Book-module--body--Hy0rr ol,.Book-module--body--Hy0rr ul{padding-left:1.5em}.Book-module--body--Hy0rr hr{margin:8px 0}.Book-module--body--Hy0rr pre{background-color:var(--color-background-primary);margin-bottom:8px;padding:24px 32px;white-space:pre-wrap}.Book-module--body--Hy0rr code,.Book-module--body--Hy0rr tt{background-color:var(--color-background-primary);padding:0 .2em}.Book-module--body--Hy0rr pre code,.Book-module--body--Hy0rr pre tt{background-color:transparent}.Book-module--body--Hy0rr iframe,.Book-module--body--Hy0rr img,.Book-module--body--Hy0rr video{margin-bottom:8px;max-width:100%}.Book-module--body--Hy0rr blockquote{border-left:.25em solid var(--color-tertiary);color:var(--color-text-secondary);padding:0 1em}.Book-module--body--Hy0rr table{border-collapse:collapse;border-spacing:0;overflow:auto;width:100%;word-break:keep-all}.Book-module--body--Hy0rr table tr{background-color:var(--color-background);border-top:1px solid var(--color-tertiary)}.Book-module--body--Hy0rr table th{font-weight:700;text-align:left}.Book-module--body--Hy0rr table td,.Book-module--body--Hy0rr table th{border:1px solid var(--color-tertiary);padding:4px 8px}@media print,screen and (max-width:768px){.Book-module--meta--2P1gP{grid-row:1}}@media print{.Book-module--meta--2P1gP{grid-column:span 3}}.Book-module--metaTitle--1KE11{margin-bottom:16px}@media screen and (max-width:768px){.Book-module--metaTitle--1KE11{display:none}}@media print{.Book-module--metaTitle--1KE11{flex-shrink:0;margin-bottom:0}.Book-module--metaTitle--1KE11:after{content:": ";padding-right:1em}}.Book-module--metaContent--1z1bA{align-items:flex-start;display:flex;flex-direction:column;margin-bottom:40px;word-break:break-word}@media print,screen and (max-width:768px){.Book-module--metaContent--1z1bA{margin-bottom:24px}}@media print{.Book-module--metaContent--1z1bA{align-items:baseline;flex-direction:row;margin-bottom:8px}}.Book-module--version--161Eu{display:none}@media print,screen and (max-width:768px){.Book-module--version--161Eu{color:var(--color-text-secondary);display:inline;margin-left:8px}}.Pagination-module--pagination--3KtNE{grid-column-gap:24px;display:grid;grid-template-columns:repeat(3,-webkit-min-content);grid-template-columns:repeat(3,min-content);margin-top:48px}@media screen and (max-width:768px){.Pagination-module--pagination--3KtNE{grid-row-gap:16px;grid-template-columns:auto auto}}.Pagination-module--pages--1Bqv1{grid-column-gap:8px;display:grid;grid-template-columns:repeat(5,42px)}.Pagination-module--page--1qgQC{background-color:var(--color-background);height:48px;width:100%}.Pagination-module--page--1qgQC:focus,.Pagination-module--page--1qgQC:hover{background-color:var(--color-background-secondary)}.Pagination-module--page--1qgQC:disabled{color:var(--color-text)}.Pagination-module--next--PX9hj{background-color:var(--color-background);padding:12px 24px}@media screen and (max-width:768px){.Pagination-module--next--PX9hj{grid-column:span 2}}.Pagination-module--current--2kpSb,.Pagination-module--next--PX9hj:focus,.Pagination-module--next--PX9hj:hover{background-color:var(--color-background-secondary)}.Pagination-module--current--2kpSb{box-shadow:0 12px 12px rgba(0,0,0,.03),0 8px 16px rgba(0,0,0,.03),0 1px 24px rgba(0,0,0,.03);pointer-events:none}.Pagination-module--ellipsis--1_1fQ{align-items:center;display:flex;justify-content:center}.Status-module--status--1dG8s{border-radius:4px;font-size:12px;font-weight:400;line-height:16px;padding:4px 8px}@media print{.Status-module--status--1dG8s{background:transparent!important;color:var(--color-text-primary)!important;padding:0!important}}.Status-module--proposed--3zY0z{background-color:var(--color-background-proposed);color:var(--color-proposed)}.Status-module--production--6xwxX{background-color:var(--color-background-production);color:var(--color-production)}.Status-module--demonstrated--2VaNN{background-color:var(--color-background-demonstrated);color:var(--color-demonstrated)}.Avatar-module--avatar--2HGSY{align-items:center;display:flex}.Avatar-module--img--3CeLS{background-color:var(--color-text-secondary);background-size:cover;border-radius:50%;height:24px;margin-right:8px;width:24px}@media print{.Avatar-module--img--3CeLS{display:none}}.Avatar-module--publisher--ktcuv{color:var(--color-primary)}.Avatar-module--avatar--2HGSY:hover .Avatar-module--publisher--ktcuv{color:var(--color-primary-hover)}.Avatar-module--avatar--2HGSY:focus .Avatar-module--publisher--ktcuv{color:var(--color-primary-pressed)}.Tags-module--tags--11-St{display:flex;flex-wrap:wrap;margin-top:-8px}.Tags-module--tags--11-St>*{margin-top:8px}.Tags-module--tags--11-St>:not(:last-child){margin-right:16px}.Tags-module--tag--14doh{border:2px solid var(--color-text-primary);border-radius:4px;color:var(--color-text-primary);font-size:12px;font-weight:400;line-height:16px;padding:4px 8px}.Tags-module--tag--14doh:hover{color:var(--color-primary-hover)}.Tags-module--tag--14doh:focus-visible{color:var(--color-primary-pressed)}@media print{.Tags-module--tag--14doh{border:none;padding:0}}.ProtocolsListItem-module--item--DycmU{background-color:var(--color-background);padding:24px 32px;width:100%;word-break:break-word}.ProtocolsListItem-module--header--17jzv{align-items:center;display:flex;flex-wrap:wrap;justify-content:space-between}@media screen and (max-width:768px){.ProtocolsListItem-module--header--17jzv{align-items:flex-start;flex-direction:column}}.ProtocolsListItem-module--title--1k0xw{color:var(--color-primary)}.ProtocolsListItem-module--title--1k0xw:hover{color:var(--color-primary-hover)}.ProtocolsListItem-module--title--1k0xw:focus{color:var(--color-primary-pressed)}@media screen and (max-width:768px){.ProtocolsListItem-module--title--1k0xw{margin-bottom:12px}}.ProtocolsListItem-module--version--1_-CI{color:var(--color-text-secondary);margin-left:8px}.ProtocolsListItem-module--summary--28MAv{margin:12px 0}.ProtocolsListItem-module--avatar--57tBG,.ProtocolsListItem-module--lastModified--3Yt0s{margin-right:16px}@media screen and (max-width:768px){.ProtocolsListItem-module--avatar--57tBG{margin-top:12px;width:100%}}.ProtocolsListItem-module--footer--35Vqh{align-items:center;display:flex;flex-direction:row-reverse;flex-wrap:wrap;justify-content:flex-end;margin-top:24px}.ProtocolsListItem-module--footer--35Vqh>:nth-child(0){order:2}.ProtocolsListItem-module--footer--35Vqh>:first-child{order:1}.ProtocolsList-module--list--1Ndxz{grid-row-gap:16px;display:grid}.Search-module--search--3XfRF{align-items:center;display:flex;max-width:514px;position:relative;width:100%}.Search-module--input--1o6QO{background-color:var(--color-background);border:1px solid transparent;box-shadow:0 12px 12px rgba(0,0,0,.03),0 8px 16px rgba(0,0,0,.03),0 1px 24px rgba(0,0,0,.03);flex-shrink:0;font-size:17px;font-weight:400;line-height:24px;padding:12px 72px 12px 16px;width:100%}.Search-module--input--1o6QO:focus,.Search-module--input--1o6QO:hover{border-color:var(--color-tertiary);box-shadow:0 12px 24px rgba(0,0,0,.06),0 8px 32px rgba(0,0,0,.06),0 4px 48px rgba(0,0,0,.06);outline:none}.Search-module--bordered--34QxG{border-color:var(--color-tertiary)}.Search-module--input--1o6QO:not(:-moz-placeholder-shown)+.Search-module--placeholder--97f4S{display:none}.Search-module--input--1o6QO:not(:placeholder-shown)+.Search-module--placeholder--97f4S{display:none}@media screen and (max-width:920px){.Search-module--placeholderExtraText--3R9o1{display:none}}.Search-module--placeholder--97f4S{color:var(--color-text-secondary);cursor:text;left:16px;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.Search-module--button--xD1TT{color:var(--color-tertiary);position:absolute;right:16px}.Search-module--button--xD1TT:focus,.Search-module--button--xD1TT:hover{color:var(--color-secondary-hover)}.Search-module--iconMagnify--j1Q9O{color:currentColor;height:24px;width:24px}.Search-module--clearButton--3MgzD{color:var(--color-text-primary);height:24px;position:absolute;right:48px;width:24px}.Search-module--clearButton--3MgzD:focus,.Search-module--clearButton--3MgzD:hover{color:var(--color-secondary-hover)}.Search-module--input--1o6QO:-moz-placeholder-shown+.Search-module--placeholder--97f4S+.Search-module--clearButton--3MgzD{display:none}.Search-module--input--1o6QO:placeholder-shown+.Search-module--placeholder--97f4S+.Search-module--clearButton--3MgzD{display:none}.Search-module--iconCross--3dnWa{color:inherit;height:24px;width:24px}._404-module--main--1taou{margin:auto;max-width:620px;width:100%}._404-module--oops--3prb5{-webkit-text-stroke:2px var(--color-secondary);color:transparent;font-size:90px;font-style:normal;font-weight:900;line-height:90px;margin-bottom:48px;text-align:center}._404-module--title--2sRC_{color:var(--color-background);margin-bottom:24px;text-align:center}._404-module--subtitle--IEi-H{color:var(--color-secondary);margin-bottom:32px;text-align:center}._404-module--search--3zs_3{display:flex;justify-content:center}@media screen and (max-width:768px){._404-module--search--3zs_3{align-items:center;bottom:16px;left:0;padding:0 16px;position:absolute;width:100%}}.Hero-module--hero--1iQtF{align-items:center;background-color:var(--color-primary);color:var(--color-background);display:flex;flex-direction:column;height:50%;padding:72px 32px;text-align:center}.Hero-module--subtitle--2Ew33{margin:16px 0 48px}@media screen and (max-width:768px){.Hero-module--subtitle--2Ew33{margin-bottom:32px}}.Hero-module--browseAll--2HlV5{margin-top:16px}.Hero-module--browseAllLink--2T_ua{color:inherit;text-decoration:underline}.Hero-module--browseAllLink--2T_ua:hover{color:var(--color-secondary-hover)}.Hero-module--browseAllLink--2T_ua:focus{color:var(--color-secondary-pressed)}.Protocol-module--title--1yzjp{margin-bottom:72px;word-break:break-word}@media screen and (max-width:768px){.Protocol-module--title--1yzjp{font-size:28px;font-weight:800;line-height:32px;margin-bottom:24px}}@media print{.Protocol-module--title--1yzjp{margin-bottom:40px}}.Protocol-module--body--3yTdm{grid-column:span 2;overflow:hidden;word-break:break-word}@media screen and (max-width:768px){.Protocol-module--body--3yTdm{grid-column:1}}@media print{.Protocol-module--body--3yTdm{grid-column:span 3;overflow:visible}}.Protocol-module--body--3yTdm>:first-child{margin-top:0}.Protocol-module--body--3yTdm h1,.Protocol-module--body--3yTdm h2{font-size:22px;font-weight:700;line-height:32px}.Protocol-module--body--3yTdm h3{font-size:20px;font-weight:600;line-height:32px}.Protocol-module--body--3yTdm h4,.Protocol-module--body--3yTdm h5,.Protocol-module--body--3yTdm h6{font-size:1rem}.Protocol-module--body--3yTdm h1,.Protocol-module--body--3yTdm h2,.Protocol-module--body--3yTdm h3,.Protocol-module--body--3yTdm h4,.Protocol-module--body--3yTdm h5,.Protocol-module--body--3yTdm h6{margin-bottom:16px;margin-top:24px}.Protocol-module--body--3yTdm ol,.Protocol-module--body--3yTdm p,.Protocol-module--body--3yTdm table,.Protocol-module--body--3yTdm ul{margin-bottom:16px}.Protocol-module--body--3yTdm a{color:var(--color-primary)}.Protocol-module--body--3yTdm a:hover{color:var(--color-primary-hover)}.Protocol-module--body--3yTdm a:focus{color:var(--color-primary-pressed)}.Protocol-module--body--3yTdm ul{list-style:initial}.Protocol-module--body--3yTdm ul ul{list-style:circle}.Protocol-module--body--3yTdm ul ul ul{list-style-type:square}.Protocol-module--body--3yTdm ol{list-style:initial}.Protocol-module--body--3yTdm ol,.Protocol-module--body--3yTdm ul{padding-left:1.5em}.Protocol-module--body--3yTdm hr{margin:8px 0}.Protocol-module--body--3yTdm pre{background-color:var(--color-background-primary);margin-bottom:8px;padding:24px 32px;white-space:pre-wrap}.Protocol-module--body--3yTdm code,.Protocol-module--body--3yTdm tt{background-color:var(--color-background-primary);padding:0 .2em}.Protocol-module--body--3yTdm pre code,.Protocol-module--body--3yTdm pre tt{background-color:transparent}.Protocol-module--body--3yTdm iframe,.Protocol-module--body--3yTdm img,.Protocol-module--body--3yTdm video{margin-bottom:8px;max-width:100%}.Protocol-module--body--3yTdm blockquote{border-left:.25em solid var(--color-tertiary);color:var(--color-text-secondary);padding:0 1em}.Protocol-module--body--3yTdm table{border-collapse:collapse;border-spacing:0;overflow:auto;width:100%;word-break:keep-all}.Protocol-module--body--3yTdm table tr{background-color:var(--color-background);border-top:1px solid var(--color-tertiary)}.Protocol-module--body--3yTdm table th{font-weight:700;text-align:left}.Protocol-module--body--3yTdm table td,.Protocol-module--body--3yTdm table th{border:1px solid var(--color-tertiary);padding:4px 8px}@media print,screen and (max-width:768px){.Protocol-module--meta--1e1pP{grid-row:1}}@media print{.Protocol-module--meta--1e1pP{grid-column:span 3}}.Protocol-module--metaTitle--PGKpJ{margin-bottom:16px}@media screen and (max-width:768px){.Protocol-module--metaTitle--PGKpJ{display:none}}@media print{.Protocol-module--metaTitle--PGKpJ{flex-shrink:0;margin-bottom:0}.Protocol-module--metaTitle--PGKpJ:after{content:": ";padding-right:1em}}.Protocol-module--metaContent--1hPYi{align-items:flex-start;display:flex;flex-direction:column;margin-bottom:40px;word-break:break-word}@media print,screen and (max-width:768px){.Protocol-module--metaContent--1hPYi{margin-bottom:24px}}@media print{.Protocol-module--metaContent--1hPYi{align-items:baseline;flex-direction:row;margin-bottom:8px}}.Protocol-module--version--vKpW5{display:none}@media print,screen and (max-width:768px){.Protocol-module--version--vKpW5{color:var(--color-text-secondary);display:inline;margin-left:8px}}.Authors-module--authors--fKUTX{display:flex;flex-wrap:wrap;margin-top:-8px}.Authors-module--authors--fKUTX>*{margin-top:8px}.Authors-module--authors--fKUTX>:not(:last-child){margin-right:16px}.Authors-module--link--2M7F6{color:var(--color-primary)}.Authors-module--link--2M7F6:hover{color:var(--color-primary-hover)}.Authors-module--link--2M7F6:focus{color:var(--color-primary-pressed)}.Checkbox-module--check--15cne{grid-column-gap:16px;align-items:center;cursor:pointer;display:grid;grid-template-columns:auto 1fr;word-break:break-word}.Checkbox-module--checkbox--2mZlv{align-items:center;display:flex;height:32px;justify-content:center;width:32px}.Checkbox-module--checkbox--2mZlv:before{border:2px solid var(--color-text-primary);border-radius:4px;content:"";display:block;height:18px;width:18px}.Checkbox-module--input--3BKOi:focus-visible+.Checkbox-module--checkbox--2mZlv,.Checkbox-module--input--3BKOi:hover+.Checkbox-module--checkbox--2mZlv{background-color:var(--color-background-primary)}.Checkbox-module--input--3BKOi:focus-visible+.Checkbox-module--checkbox--2mZlv:before,.Checkbox-module--input--3BKOi:hover+.Checkbox-module--checkbox--2mZlv:before{border-color:var(--color-primary)}.Checkbox-module--input--3BKOi:checked+.Checkbox-module--checkbox--2mZlv:before{background-color:var(--color-primary);background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='13' height='10' fill='none' viewBox='0 0 13 10'%3E%3Cpath fill='%23fff' d='M12.99 2 11.58.58 4.99 7.17 2.41 4.6.99 6.01l4 3.99 8-8z'/%3E%3C/svg%3E");background-position-y:50%;background-repeat:no-repeat;border-color:var(--color-primary)}.Button-module--button--2t432{align-items:center;display:flex;justify-content:center;padding:12px 24px}.Button-module--button--2t432:focus,.Button-module--button--2t432:hover{box-shadow:0 12px 24px rgba(0,0,0,.06),0 8px 32px rgba(0,0,0,.06),0 4px 48px rgba(0,0,0,.06);outline:none}.Button-module--expanded--1tS7m{max-width:400px;width:100%}.Button-module--primary--1Znlo{background-color:var(--color-background-primary);color:var(--color-primary)}.Button-module--primary--1Znlo:hover{background-color:var(--color-background-primary-hover)}.Button-module--primary--1Znlo:focus-visible{background-color:var(--color-background-primary-pressed)}.Button-module--secondary--2lup3{background-color:var(--color-secondary)}.Button-module--secondary--2lup3:hover{background-color:var(--color-secondary-hover)}.Button-module--secondary--2lup3:focus-visible{background-color:var(--color-secondary-pressed)}.Button-module--icon--ahMay{color:var(--color-primary);height:24px;margin-right:16px;width:24px}.Filters-module--title--2w9oT{margin-bottom:40px}@media screen and (max-width:768px){.Filters-module--title--2w9oT{font-size:28px;font-weight:800;line-height:32px}}.Filters-module--group--39W7Y{margin-bottom:40px}.Filters-module--groupTitle--7YFdO{margin-bottom:16px}.Filters-module--filter--FPzWd{margin-bottom:8px}.Radio-module--label--3mVdI{margin-left:8px;word-break:break-word}.Radio-module--radio--1Zv1U{align-items:center;cursor:pointer;display:flex}.Radio-module--control--1gBRR{align-items:center;border-radius:50%;color:var(--color-text-primary);display:flex;height:32px;justify-content:center;width:32px}.Radio-module--control--1gBRR:before{border-radius:50%;content:"";display:inline-block;height:10px;position:absolute;width:10px}.Radio-module--control--1gBRR:after{border:2px solid;border-radius:50%;content:"";display:inline-block;height:20px;position:absolute;width:20px}.Radio-module--input--1y39W:checked+.Radio-module--control--1gBRR,.Radio-module--input--1y39W:hover+.Radio-module--control--1gBRR{color:var(--color-primary-hover)}.Radio-module--input--1y39W:focus-visible+.Radio-module--control--1gBRR,.Radio-module--input--1y39W:hover+.Radio-module--control--1gBRR{background-color:var(--color-background-primary);color:var(--color-primary-hover)}.Chips-module--chips--2PD3E,.Radio-module--input--1y39W:checked+.Radio-module--control--1gBRR:before{background-color:var(--color-primary)}.Chips-module--chips--2PD3E{align-items:center;border-radius:20px;color:var(--color-background);display:flex;padding:4px 16px}.Chips-module--content--1fRc1{margin-right:8px;word-break:break-word}.Chips-module--action--18xz2{color:inherit}.Chips-module--action--18xz2:hover{color:var(--color-secondary-hover)}.Chips-module--action--18xz2:focus-visible{color:var(--color-secondary-pressed)}.Chips-module--actionIcon--3Mnic{color:inherit;height:24px;width:24px}.Search-module--title--2Sv1D{word-wrap:break-word;font-size:34px;font-weight:900;line-height:40px;margin-bottom:48px}@media screen and (max-width:768px){.Search-module--title--2Sv1D{font-size:28px;font-weight:800;line-height:32px;margin-bottom:24px}}.Search-module--mark--1mwSB{background-color:var(--color-secondary);display:inline-block;line-height:0em;padding-bottom:.5em}.Search-module--chipsContainer--Q20QU{display:flex;flex-wrap:wrap;margin-bottom:24px;margin-top:-8px}.Search-module--chips--kTcRd{margin-top:8px}.Search-module--chips--kTcRd:not(:last-child){margin-right:8px}.Search-module--main--2W9_R{grid-column:span 2}@media screen and (max-width:768px){.Search-module--filters--3UUwN{background-color:var(--color-background);display:block;left:0;max-height:100vh;max-height:-webkit-fill-available;overflow-y:auto;padding:40px 16px;position:fixed;top:0;width:100vw;z-index:1000}}.Search-module--close--2JH3A{position:absolute;right:24px;top:40px}.Search-module--close--2JH3A:hover{color:var(--color-secondary-hover)}.Search-module--close--2JH3A:focus-visible{color:var(--color-secondary-pressed)}.Search-module--close--2JH3A:focus{outline:none}.Search-module--closeIcon--1pWvM{height:24px;width:24px}.Search-module--showFilters--1l0jQ{margin-bottom:24px}</style><meta name="generator" content="Gatsby 3.14.6"/><title data-react-helmet="true">Message Pickup | DIDComm</title><link data-react-helmet="true" rel="preconnect" href="https://fonts.googleapis.com"/><link data-react-helmet="true" rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><link data-react-helmet="true" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&amp;display=swap" rel="stylesheet"/><meta data-react-helmet="true" name="description" content="DIDComm lets people and software use DIDs to communicate securely and privately over many channels: the web, email, mobile push notifications, QR codes, Bluetooth, message queues, sneakernet, and more."/><meta data-react-helmet="true" property="og:title" content="Message Pickup"/><meta data-react-helmet="true" property="og:description" content="DIDComm lets people and software use DIDs to communicate securely and privately over many channels: the web, email, mobile push notifications, QR codes, Bluetooth, message queues, sneakernet, and more."/><meta data-react-helmet="true" property="og:type" content="website"/><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="icon" href="/favicon-32x32.png?v=b85920628d9d315a1905d4e53f7a73b6" type="image/png"/><link rel="icon" href="/favicon.svg?v=b85920628d9d315a1905d4e53f7a73b6" type="image/svg+xml"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#FFF"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=b85920628d9d315a1905d4e53f7a73b6"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=b85920628d9d315a1905d4e53f7a73b6"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=b85920628d9d315a1905d4e53f7a73b6"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=b85920628d9d315a1905d4e53f7a73b6"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=b85920628d9d315a1905d4e53f7a73b6"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=b85920628d9d315a1905d4e53f7a73b6"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=b85920628d9d315a1905d4e53f7a73b6"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=b85920628d9d315a1905d4e53f7a73b6"/><link as="script" rel="preload" href="/webpack-runtime-7b527356047a9787095f.js"/><link as="script" rel="preload" href="/framework-0993f47ffebd3bbb5409.js"/><link as="script" rel="preload" href="/app-66c5ca6594b84d75c649.js"/><link as="script" rel="preload" href="/commons-ceb25d5ebe4b77987b3b.js"/><link as="script" rel="preload" href="/component---src-templates-protocol-protocol-tsx-3391b2f00d0a4ae5a5c3.js"/><link as="fetch" rel="preload" href="/page-data/messagepickup/4.0/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3000541721.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3766577012.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--36KWw"><header class="Header-module--header--1Qt4T hide-print"><div class="Header-module--container--3KhaC"><a title="Link to home" class="Header-module--logo--RPmCm" aria-label="Link to home" href="/"><svg class="Header-module--logoImg--f8A17"><use href="/static/33a1b05c5807b13800487409ee2ac2cd/icons.svg#logo"></use></svg><span class="Header-module--logoText--EwM4- hide-mobile">DIDComm</span></a><div class="Header-module--search--ucYp8"><form class="Search-module--search--3XfRF" role="search"><input type="text" class="Search-module--input--1o6QO rounded Search-module--bordered--34QxG" value="" autoCorrect="off" placeholder=" " autoComplete="off" id="search"/><label class="Search-module--placeholder--97f4S" for="search">Search protocols<span class="Search-module--placeholderExtraText--3R9o1"> to use in your own software</span></label><button class="Search-module--clearButton--3MgzD" aria-label="Clear search text" type="button"><svg class="Search-module--iconCross--3dnWa"><use href="/static/33a1b05c5807b13800487409ee2ac2cd/icons.svg#cross"></use></svg></button><button class="Search-module--button--xD1TT" type="submit" aria-label="Search for protocols"><svg class="Search-module--iconMagnify--j1Q9O"><use href="/static/33a1b05c5807b13800487409ee2ac2cd/icons.svg#magnify"></use></svg></button></form></div><nav class="hide-mobile font-footnote Header-module--linksContainer--WRDuP"><ul class="Header-module--links--3cZB-"><li><a class="Header-module--link--4ebYS" rel="noreferrer noopener nofollow" href="https://github.com/decentralized-identity/didcomm.org" target="_blank">GitHub repo</a></li><li><a class="Header-module--link--4ebYS" rel="noreferrer noopener nofollow" href="https://identity.foundation/didcomm-messaging/spec/v2.1/" target="_blank">Specification</a></li><li><a class="Header-module--link--4ebYS" href="mailto:security@didcomm.org">Security</a></li></ul></nav></div></header><div class="content"><main><h1 class="font-title-1 Protocol-module--title--1yzjp">Message Pickup<!-- --> <span class="font-footnote Protocol-module--version--vKpW5">4.0</span></h1><div class="grid-3"><article class="Protocol-module--body--3yTdm"><h2>Summary</h2><p>A protocol to facilitate an agent picking up messages held at a mediator.</p><div><h2 id="Summary">Summary</h2>
<p>A protocol to facilitate a <em>Recipient</em> agent picking up messages held at a <em>Mediator</em>. This protocol is likely to be used in tandem with the <a href="https://didcomm.org/coordinate-mediation/3.0/">Cooridinate Mediation protocol</a>.</p>
<h2 id="Motivation">Motivation</h2>
<p>This protocol is needed to facilitate retrieval of messages from a mediator in an explicit manner. Additionally, this protocol provides behavior for initiating live delivery of messages, which is crucial for good user experience for agents operating on mobile devices.</p>
<p>Motivation for v4 of this protocol primarily stems from ambiguity in the <a href="https://github.com/hyperledger/aries-rfcs/tree/main/features/0685-pickup-v2">pickup v2 protocol</a> and <a href="https://didcomm.org/messagepickup/3.0/">messagepickup v3 protocol</a> as to whether <code>delivery</code> and <code>messages-received</code> messages must be used while using live mode.</p>
<h2 id="Version-Change-Log">Version Change Log</h2>
<h3 id="40">4.0</h3>
<ul>
<li>Clarifies that <code>delivery</code> and <code>messages-received</code> messages MUST be used while using <em>Live Mode</em> to ensure delivery of all messages.</li>
<li>Adjusts handling of <code>delivery-request</code> messages when no messages are queued to be delivered. Rather than sending a status message indicating no messages are queued, an empty delivery message is sent. This was chosen to reduce complexity of the protocol.</li>
<li>Adds DIDComm v1 message format (pickup v3 only contained DIDComm v2).
<ul>
<li>In pickup v4 while using DIDComm v1, every <code>recipient_did</code> must be a <a href="https://github.com/hyperledger/aries-rfcs/tree/main/features/0360-use-did-key"><code>did:key</code> reference</a>.</li>
</ul>
</li>
<li>Adjustments to the protocol's use of thread ids
<ul>
<li>Added thread id to <code>status</code> messages, as status messages are always in response to an original message from the <code>recipient</code>.</li>
<li>Made the thread id (thid) on <code>delivery</code> messages optional, as messages received in <em>Live Mode</em> do not have an associated <code>delivery-request</code> message.</li>
</ul>
</li>
<li>Removed return route all from <code>messages-received</code> messages, as it is not required.</li>
<li>Updates protocol-name to <code>message-pickup</code>.</li>
<li>Removes the <code>longest_waited_seconds</code> field on the <code>status</code> message (as it is redundant in regards to <code>oldest_received_time</code>).</li>
<li>Renames <code>limit</code> in the <code>delivery-request</code> to <code>message_count_limit</code> for increased specificity.</li>
<li>Adjusts timing fields to be specified in UTC Epoch milliseconds instead of seconds for greater precision.</li>
</ul>
<h2 id="Roles">Roles</h2>
<p>There are two roles in this protocol:</p>
<ul>
<li><code>mediator</code>: The agent that has messages waiting for pickup by the <code>recipient</code>.</li>
<li><code>recipient</code>: The agent who is picking up messages from the <code>mediator</code>.</li>
</ul>
<h2 id="Requirements">Requirements</h2>
<h3 id="Return-Route">Return Route</h3>
<p>The <code>return_route</code> extension must be supported by both agents (<code>recipient</code> and <code>mediator</code>).
The common use of this protocol is for the reply messages from the <code>mediator</code> to be synchronous, utilizing the same connection channel for the reply. In order to have this synchronous behavior the <code>recipient</code> should specify <code>return_route</code> header to <code>all</code>.
This header must be set each time the communication channel is established: once per established websocket, and every message for an HTTP POST.</p>
<h3 id="DIDComm-V1-Requirements">DIDComm V1 Requirements</h3>
<p>When using this protocol with DIDComm V1, <code>recipient_did</code> <strong>MUST</strong> be a <a href="https://github.com/hyperledger/aries-rfcs/tree/main/features/0360-use-did-key"><code>did:key</code> reference</a>.</p>
<h2 id="Basic-Walkthrough">Basic Walkthrough</h2>
<p>This protocol consists of three different message requests from the <code>recipient</code> that should be replied to by the <code>mediator</code>:</p>
<ol>
<li>Status Request -&gt; Status</li>
<li>Delivery Request -&gt; Message Delivery -&gt; Message Received</li>
<li>Live Mode -&gt; Status or Problem Report -&gt; Message Delivery -&gt; Message Received</li>
</ol>
<h2 id="States">States</h2>
<p>This protocol follows the request-response message exchange pattern, and only requires the simple state of waiting for a response or to produce a response.</p>
<p>Additionally, the <code>return_route</code> header extension must be set to <code>all</code> in all request submitted by the <code>recipient</code>.</p>
<h2 id="Basic-Walkthrough-1">Basic Walkthrough</h2>
<p>The <code>status-request</code> message is sent by the <code>recipient</code> to the <code>mediator</code> to query how many messages are pending.</p>
<p>The <code>status</code> message is the response to <code>status-request</code> to communicate the state of the message queue.</p>
<p>The <code>delivery-request</code> message is sent by the <code>recipient</code> to request delivery of pending messages.</p>
<p>The <code>delivery</code> message is the response to the <code>delivery-request</code> to send queued messages back to the <code>recipient</code>.</p>
<p>The <code>messages-received</code> message is sent by the <code>recipient</code> to confirm receipt of delivered messages, prompting the <code>mediator</code> to clear messages from the queue.</p>
<p>The <code>live-delivery-change</code> message is used to set the state of <code>live_delivery</code>.</p>
<p>When <em>Live Mode</em> is enabled, messages that arrive when an existing connection exists are delivered over the connection immediately, via a <code>delivery</code> message, rather than being pushed to the queue. See <em>Live Mode</em> below for more details.</p>
<h2 id="Security">Security</h2>
<p>This protocol expects messages to be encrypted during transmission, and repudiable.</p>
<h2 id="Message-Reference">Message Reference</h2>
<h3 id="Status-Request">Status Request</h3>
<p>Sent by the <code>recipient</code> to the <code>mediator</code> to request a <code>status</code> message.</p>
<p>Message Type URI: <code>https://didcomm.org/message-pickup/4.0/status-request</code></p>
<p>DIDComm v1 example:</p>
<pre><code class="language-json">{
    "@id": "123456780",
    "@type": "https://didcomm.org/message-pickup/4.0/status-request",
    "recipient_did": "&lt;did:key for messages&gt;",
    "~transport": {
        "return_route": "all"
    }
}
</code></pre>
<p>DIDComm v2 example:</p>
<pre><code class="language-json">{
    "id": "123456780",
    "type": "https://didcomm.org/message-pickup/4.0/status-request",
    "body" : {
        "recipient_did": "&lt;did for messages&gt;"
    },
    "return_route": "all"
}
</code></pre>
<p><code>recipient_did</code> is optional. When specified, the <code>mediator</code> <strong>MUST</strong> only return status related to that recipient did. This allows the <code>recipient</code> to discover if any messages are in the queue that were sent to a specific DID. If using DIDComm v1, <code>recipient_did</code> <strong>MUST</strong> be a <a href="https://github.com/hyperledger/aries-rfcs/tree/main/features/0360-use-did-key"><code>did:key</code> reference</a>.</p>
<h3 id="Status">Status</h3>
<p>Status details about waiting messages.</p>
<p>Message Type URI: <code>https://didcomm.org/message-pickup/4.0/status</code></p>
<p>DIDComm v1 example:</p>
<pre><code class="language-json">{
    "@id": "123456780",
    "@type": "https://didcomm.org/message-pickup/4.0/status",
    "~thread": {
        "thid": "&lt;message id of status-request message&gt;"
    },
    "recipient_did": "&lt;did:key for messages&gt;",
    "message_count": 7,
    "newest_received_time": 1739420343823,
    "oldest_received_time": 1739420343823,
    "total_bytes": 8096,
    "live_delivery": false
}
</code></pre>
<p>DIDComm v2 example:</p>
<pre><code class="language-json">{
    "id": "123456780",
    "thid": "&lt;message id of status-request message&gt;",
    "type": "https://didcomm.org/message-pickup/4.0/status",
    "body": {
        "recipient_did": "&lt;did for messages&gt;",
        "message_count": 7,
        "newest_received_time": 1739420343823,
        "oldest_received_time": 1739420343823,
        "total_bytes": 8096,
        "live_delivery": false
    }
}
</code></pre>
<p><code>message_count</code> is the only <strong>REQUIRED</strong> attribute. The others <strong>MAY</strong> be present if offered by the <code>mediator</code>.</p>
<p><code>newest_received_time</code> and <code>oldest_received_time</code> are expressed in UTC Epoch Milliseconds (Milliseconds since 1970-01-01T00:00:00Z) as an integer.</p>
<p><code>total_bytes</code> represents the total size of all messages.</p>
<p>If a <code>recipient_did</code> was specified in the <code>status-request</code> message, the matching value <strong>MUST</strong> be specified in the <code>recipient_did</code> attribute of the status message.</p>
<p><code>live_delivery</code> state is also indicated in the status message.</p>
<p><strong>Note</strong>: due to the potential for confusing what the actual state of the message queue is, a <code>status</code> message <strong>MUST NOT</strong> be put on the pending message queue and <strong>MUST</strong> only be sent when the <code>recipient</code> is actively connected (HTTP request awaiting response, WebSocket, etc.).</p>
<h3 id="Delivery-Request">Delivery Request</h3>
<p>A request from the <code>recipient</code> to the <code>mediator</code> to have pending messages delivered.</p>
<p>Message Type URI: <code>https://didcomm.org/message-pickup/4.0/delivery-request</code></p>
<p>DIDComm v1 example:</p>
<pre><code class="language-json">{
    "@id": "123456780",
    "@type": "https://didcomm.org/message-pickup/4.0/delivery-request",
    "message_count_limit": 10,
    "recipient_did": "&lt;did:key for messages&gt;",
    "~transport": {
        "return_route": "all"
    }
}
</code></pre>
<p>DIDComm v2 example:</p>
<pre><code class="language-json">{
    "id": "123456780",
    "type": "https://didcomm.org/message-pickup/4.0/delivery-request",
    "body": {
        "message_count_limit": 10,
        "recipient_did": "&lt;did for messages&gt;"
    },
    "return_route": "all"
}
</code></pre>
<p><code>message_count_limit</code> is a <strong>REQUIRED</strong> attribute, and after receipt of this message, the <code>mediator</code> <strong>SHOULD</strong> deliver up to the limit indicated.</p>
<p><code>recipient_did</code> is optional. When specified, the <code>mediator</code> <strong>MUST</strong> only return messages sent to that recipient did.</p>
<p>If no messages are available to be sent, a <code>delivery</code> message with an empty attachments array <strong>MUST</strong> be sent immediately.</p>
<p>Delivered messages <strong>MUST NOT</strong> be deleted until delivery is acknowledged by a <code>messages-received</code> message.</p>
<h3 id="Message-Delivery">Message Delivery</h3>
<p>Batch of messages delivered to the <code>recipient</code> as attachments.</p>
<p>Message Type URI: <code>https://didcomm.org/message-pickup/4.0/delivery</code></p>
<p>DIDComm v1 example:</p>
<pre><code class="language-json">{
    "@id": "123456780",
    "@type": "https://didcomm.org/message-pickup/4.0/delivery",
    "~thread": {
        "thid": "&lt;message id of delivery-request message&gt;"
    },
    "recipient_did": "&lt;did:key for messages&gt;",
    "~attach": [{
        "@id": "&lt;id of message&gt;",
        "data": {
            "base64": "&lt;message&gt;"
        }
    }]
}
</code></pre>
<p>DIDComm v2 example:</p>
<pre><code class="language-json">{
    "id": "123456780",
    "thid": "&lt;message id of delivery-request message&gt;",
    "type": "https://didcomm.org/message-pickup/4.0/delivery",
    "body": {
        "recipient_did": "&lt;did for messages&gt;"
    },
    "attachments": [{
        "id": "&lt;id of message&gt;",
        "data": {
            "base64": "&lt;message&gt;"
        }
    }]
}
</code></pre>
<p>Messages delivered from the queue <strong>MUST</strong> be delivered in a delivery message as attachments. If the <code>delivery</code> message is in response to a <code>delivery-request</code> message that specifies a <code>message_count_limit</code>, the number of attached messages <strong>MUST NOT</strong> exceed the <code>message_count_limit</code> specified in the <code>delivery-request</code>.
The <code>id</code> of each attachment is used to confirm receipt.
The <code>id</code> is an opaque value, and the recipient <strong>SHOULD NOT</strong> deduce any information from it, except that it is unique to the mediator. The recipient can use the <code>id</code>s in the <code>message_id_list</code> field of <code>messages-received</code>.</p>
<p>If there are no messages in the queue for the <code>delivery-request</code>, the <code>delivery</code> message <strong>MUST</strong> contain an empty array of attachments.</p>
<p>The ONLY valid type of attachment for this message is a DIDComm v1 or v2 Message in encrypted form.</p>
<p><code>thid</code> -- an optional field if the delivery message is in response to a singular <code>delivery-request</code> messsage.</p>
<p>The <code>recipient_did</code> attribute is only included when responding to a <code>delivery-request</code> message that indicates a <code>recipient_did</code>.</p>
<h3 id="Messages-Received">Messages Received</h3>
<p>After receiving messages, the <code>recipient</code> <strong>MUST</strong> send an acknowledge message indiciating which messages are safe to clear from the queue.</p>
<p>Message Type URI: <code>https://didcomm.org/message-pickup/4.0/messages-received</code></p>
<p>DIDComm v1 example:</p>
<pre><code class="language-json">{
    "@id": "123456780",
    "@type": "https://didcomm.org/message-pickup/4.0/messages-received",
    "message_id_list": ["123","456"]
}
</code></pre>
<p>DIDComm v2 example:</p>
<pre><code class="language-json">{
    "id": "123456780",
    "type": "https://didcomm.org/message-pickup/4.0/messages-received",
    "body": {
        "message_id_list": ["123","456"]
    }
}
</code></pre>
<p><code>message_id_list</code> is a list of <code>ids</code> of each message received. The <code>id</code> of each message is present in the attachment descriptor of each attached message of a delivery message.</p>
<p>Upon receipt of this message, the <code>mediator</code> knows which messages have been received, and can remove them from the collection of queued messages with confidence.</p>
<h4 id="Multiple-Recipients">Multiple Recipients</h4>
<p>If a message arrives at a <code>mediator</code> addressed to multiple <code>recipients</code>, the message <strong>MUST</strong> be queued for each <code>recipient</code> independently. If one of the addressed <code>recipients</code> retrieves a message and indicates it has been received, that message <strong>MUST</strong> still be held and then removed by the other addressed <code>recipients</code>.</p>
<h3 id="Live-Mode">Live Mode</h3>
<p><em>Live Mode</em> is the practice of delivering newly arriving messages directly to a connected <code>recipient</code>. It is disabled by default and only activated by the <code>recipient</code>. Messages that arrive when <em>Live Mode</em> is off <strong>MUST</strong> be stored in the queue for retrieval as described above. If <em>Live Mode</em> is active, and the connection is broken, a new inbound connection starts with <em>Live Mode</em> disabled.</p>
<p>Messages already in the queue are not affected by <em>Live Mode</em>; they <strong>MUST</strong> still be requested with <code>delivery-request</code> messages.</p>
<p><em>Live Mode</em> <strong>MUST</strong> only be enabled when a persistent transport is used, such as WebSockets.</p>
<p>If <em>Live Mode</em> is active, messages still <strong>MUST</strong> be delivered via a <code>delivery</code> message and the <code>recipient</code> <strong>MUST</strong> send an acknowledgement message <code>messages-received</code>. If a message is not acknowledged, the message <strong>MUST</strong> be added to the queue for later pickup.</p>
<p>Recipients have three modes of possible operation for message delivery with various abilities and level of development complexity:</p>
<ol>
<li>Never activate <em>Live Mode</em>. Poll for new messages with a <code>status_request</code> message, and retrieve them when available.</li>
<li>Retrieve all messages from queue, and then activate <em>Live Mode</em>. This simplifies message processing logic in the <code>recipient</code>.</li>
<li>Activate <em>Live Mode</em> immediately upon connecting to the <code>mediator</code>. Retrieve messages from the queue as possible. When receiving a message delivered live, the queue may be queried for any waiting messages delivered to the same did for processing.</li>
</ol>
<h3 id="Live-Mode-Change">Live Mode Change</h3>
<p><em>Live Mode</em> is changed with a <code>live-delivery-change</code> message.</p>
<p>Message Type URI: <code>https://didcomm.org/message-pickup/4.0/live-delivery-change</code></p>
<p>DIDComm v1 example:</p>
<pre><code class="language-json">{
    "@id": "123456780",
    "@type": "https://didcomm.org/message-pickup/4.0/live-delivery-change",
    "live_delivery": true
}
</code></pre>
<p>DIDComm v2 example:</p>
<pre><code class="language-json">{
    "id": "123456780",
    "type": "https://didcomm.org/message-pickup/4.0/live-delivery-change",
    "body": {
        "live_delivery": true
    }
}
</code></pre>
<p>Upon receiving the <code>live_delivery_change</code> message, the <code>mediator</code> <strong>MUST</strong> respond with a <code>status</code> message.</p>
<p>If sent with <code>live_delivery</code> set to true on a connection incapable of live delivery, a <code>problem_report</code> <strong>SHOULD</strong> be sent as follows:</p>
<p>DIDComm v1 example:</p>
<pre><code class="language-json">{
    "@id": "123456780",
    "@type": "https://didcomm.org/message-pickup/4.0/problem-report",
    "~thread": {
        "pthid": "&lt;the value is the thid of the thread in which the problem occurred&gt;"
    },
    "description": {
        "code": "e.m.live-mode-not-supported",
        "en": "Connection does not support Live Delivery"
    }
}
</code></pre>
<p>DIDComm v2 example:</p>
<pre><code class="language-json">{
    "id": "123456780",
    "type": "https://didcomm.org/message-pickup/4.0/problem-report",
    "pthid": "&lt;the value is the thid of the thread in which the problem occurred&gt;",
    "body": {
        "code": "e.m.live-mode-not-supported",
        "comment": "Connection does not support Live Delivery"
    }
}
</code></pre>
<h2 id="L10n">L10n</h2>
<p>No localization is required.</p>
<h2 id="Implementations">Implementations</h2>
<table>
<thead>
<tr>
<th>Name / Link</th>
<th>Implementation Notes</th>
</tr>
</thead>
</table>
<h2 id="Endnotes">Endnotes</h2>
<h3 id="Future-Considerations">Future Considerations</h3>
<p>The style of wrapping messages in a <code>delivery</code> message incurs an additional roughly 33% increased message size due to wrapping of the message. This size bloating is outweighed by the benefit of having explicit and guaranteed delivery of messages. This issue may be resolved in future versions of DIDComm.</p>
<p>Should there be a strategy for a <code>mediator</code> to indicate support for <em>Live Mode</em> via discover features?</p></div></article><div class="Protocol-module--meta--1e1pP"><div class="Protocol-module--metaContent--1hPYi"><div class="font-subheadline Protocol-module--metaTitle--PGKpJ">PIURI</div><div class="font-footnote">https://didcomm.org/message-pickup/4.0</div></div><div class="Protocol-module--metaContent--1hPYi"><div class="font-subheadline Protocol-module--metaTitle--PGKpJ">Status</div><div class="Status-module--status--1dG8s Status-module--production--6xwxX">Production</div></div><div class="Protocol-module--metaContent--1hPYi"><div class="font-subheadline Protocol-module--metaTitle--PGKpJ">Hashtags</div><div class="Tags-module--tags--11-St"></div></div><div class="Protocol-module--metaContent--1hPYi"><div class="font-subheadline Protocol-module--metaTitle--PGKpJ">Publisher</div><a rel="noreferrer noopener nofollow" aria-label="GitHub profile JamesKEbert" class="Avatar-module--avatar--2HGSY" target="_blank" href="https://github.com/JamesKEbert"><div style="background-image:url(https://avatars.githubusercontent.com/u/30242284?v=4&amp;s=48)" class="Avatar-module--img--3CeLS font-footnote"></div><span class="font-footnote Avatar-module--publisher--ktcuv">@<!-- -->JamesKEbert</span></a></div><div class="Protocol-module--metaContent--1hPYi"><div class="font-subheadline Protocol-module--metaTitle--PGKpJ">Authors</div><div class="Authors-module--authors--fKUTX"><a class="font-footnote Authors-module--link--2M7F6" href="mailto:telegramsam@gmail.com">Sam Curren</a><a class="font-footnote Authors-module--link--2M7F6" href="mailto:james@jamesebert.dev">James Ebert</a></div></div><div class="hide-mobile hide-print"><div class="Protocol-module--metaContent--1hPYi"><div class="font-subheadline Protocol-module--metaTitle--PGKpJ">Version</div><div class="font-footnote">4.0</div></div></div><div class="Protocol-module--metaContent--1hPYi"><div class="font-subheadline Protocol-module--metaTitle--PGKpJ">License</div><div class="font-footnote">MIT</div></div><div class="Protocol-module--metaContent--1hPYi"><div class="font-subheadline Protocol-module--metaTitle--PGKpJ">Last modified</div><span class="font-footnote">2025 Mar 17, 19:03 PM</span></div></div></div></main></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/messagepickup/4.0/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-5cf53654e1a73056adc6.js"],"app":["/app-66c5ca6594b84d75c649.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-06fe7db8f8c75ad21a4d.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-eb4a3aa53617243254eb.js"],"component---src-templates-book-book-tsx":["/component---src-templates-book-book-tsx-f87c4cd85a9942002b2d.js"],"component---src-templates-protocol-protocol-tsx":["/component---src-templates-protocol-protocol-tsx-3391b2f00d0a4ae5a5c3.js"],"component---src-templates-search-search-tsx":["/component---src-templates-search-search-tsx-e8abc6de2d7bc98ba3a7.js"]};/*]]>*/</script><script src="/polyfill-5cf53654e1a73056adc6.js" nomodule=""></script><script src="/component---src-templates-protocol-protocol-tsx-3391b2f00d0a4ae5a5c3.js" async=""></script><script src="/commons-ceb25d5ebe4b77987b3b.js" async=""></script><script src="/app-66c5ca6594b84d75c649.js" async=""></script><script src="/framework-0993f47ffebd3bbb5409.js" async=""></script><script src="/webpack-runtime-7b527356047a9787095f.js" async=""></script></body></html>